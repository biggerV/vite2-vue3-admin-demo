var l=Object.defineProperty,e=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,i=(e,a,t)=>a in e?l(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t;import{q as s,f as o}from"./index.6066ce25.js";import{p as d,a as n,b as r,Y as c,l as m,o as u,d as k,e as f,f as g,t as p,F as h,g as b,n as y,w as C}from"./vendor.cd5cedf3.js";const T={name:"Calendar",components:{},data:()=>({loading:!1,submitLoading:!1,value:new Date,list:{},tasksDialogVisible:!1,dialogTaskObj:[],addTaskDialogVisible:!1,form:{title:"",content:""},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]}}),created(){this.getCalendarTaskList()},methods:{getCalendarTaskList(){this.loading=!0,s().then((l=>{0===l.code?this.list=l.data:this.$message.error(l.desc)})).finally((()=>{this.loading=!1}))},handleClickCell(l,e){if(this.tasksDialogVisible=!this.tasksDialogVisible,l)this.dialogTaskObj=l;else{const l={id:parseInt(100*Math.random()),tasks:[]};this.list[e.day]=l,this.dialogTaskObj=l}this.dialogTaskObj.day=e.day},handleClickAddTask(){this.form={},this.addTaskDialogVisible=!this.addTaskDialogVisible},submitForm(l){this.$refs[l].validate((l=>{if(!l)return!1;this.submitLoading=!0,o().then((()=>{if(this.$message.success("保存成功"),this.form.id)this.dialogTaskObj.tasks.map((l=>{l.id==this.form.id&&(l.title=this.form.title,l.content=this.form.content)}));else{const l=((l,s)=>{for(var o in s||(s={}))a.call(s,o)&&i(l,o,s[o]);if(e)for(var o of e(s))t.call(s,o)&&i(l,o,s[o]);return l})({id:parseInt(100*Math.random())},this.form);this.dialogTaskObj.tasks.push(l),this.form={}}this.submitLoading=!1}))}))},handleClickDelTask(l){this.dialogTaskObj.tasks.splice(l,1)},handleClickEditTask(l){this.form=JSON.parse(JSON.stringify(l)),this.addTaskDialogVisible=!0},addCellCls(l){const e=new Date(l.day).getTime(),a=new Date(dayjs().format("YYYY-MM-DD")).getTime();return e>a?"after-today":e<a?"before-today":void 0}}},V=C();d("data-v-3a7df5ee");const v={key:0,class:"li2"},j=f("i",{class:"el-icon-plus"},null,-1),D={class:"task-dialog-content"},O={style:{"text-align":"right"}},_=f("i",{class:"el-icon-delete"},null,-1),$=f("i",{class:"el-icon-edit"},null,-1),w=g("保存");n();const x=V(((l,e,a,t,i,s)=>{const o=r("el-popover"),d=r("el-calendar"),n=r("el-button"),C=r("el-collapse-item"),T=r("el-collapse"),x=r("el-alert"),L=r("el-dialog"),M=r("el-input"),U=r("el-form-item"),Y=r("el-form"),z=c("loading");return m((u(),k("div",null,[f(d,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=l=>i.value=l)},{dateCell:V((({data:l})=>[g(p(l.day.split("-").slice(2).join(""))+" ",1),i.list[l.day]?(u(),k(o,{key:0,ref:"popover",placement:"top",title:`事项（${l.day}）`,width:250,trigger:"hover"},{reference:V((()=>[f("div",{class:s.addCellCls(l)},[f("div",{onClick:e=>s.handleClickCell(i.list[l.day],l),class:"cell"},[(u(!0),k(h,null,b(i.list[l.day].tasks,((l,e)=>(u(),k(h,null,[e<2?(u(),k("div",{key:`b${l.id}`,class:"li"},[f("span",{title:l.title,class:"title"},p(l.title),9,["title"])])):y("",!0)],64)))),256)),i.list[l.day].tasks.length>2?(u(),k("div",v,"还有"+p(i.list[l.day].tasks.length-2)+"个事项",1)):y("",!0)],8,["onClick"])],2)])),default:V((()=>[f("ol",null,[(u(!0),k(h,null,b(i.list[l.day].tasks,(l=>(u(),k("li",{key:`a${l.id}`},[f("span",{title:l.title,class:"title"},p(l.title),9,["title"])])))),128))])])),_:2},1032,["title"])):(u(),k("div",{key:1,onClick:e=>s.handleClickCell(null,l),class:"cell"},null,8,["onClick"]))])),_:1},8,["modelValue"]),f(L,{title:`事项（${i.dialogTaskObj.day}）`,modelValue:i.tasksDialogVisible,"onUpdate:modelValue":e[2]||(e[2]=l=>i.tasksDialogVisible=l)},{default:V((()=>[f(n,{size:"mini",type:"primary",plain:"",onClick:s.handleClickAddTask,style:{"margin-bottom":"10px"}},{default:V((()=>[j,g(" "+p(l.$t("新增")),1)])),_:1},8,["onClick"]),i.dialogTaskObj.tasks.length?(u(),k(T,{key:0},{default:V((()=>[(u(!0),k(h,null,b(i.dialogTaskObj.tasks,((e,a)=>(u(),k(C,{key:`a${a}`,title:`${a+1}）${e.title}`,name:a},{default:V((()=>[f("div",D,[f("div",{style:{"margin-bottom":"10px"},innerHTML:e.content.replace(/\n/g,"<br />")},null,8,["innerHTML"]),f("div",O,[f(n,{size:"mini",onClick:l=>s.handleClickDelTask(a)},{default:V((()=>[_,g(" "+p(l.$t("删除")),1)])),_:2},1032,["onClick"]),f(n,{size:"mini",onClick:l=>s.handleClickEditTask(e)},{default:V((()=>[$,g(" "+p(l.$t("编辑")),1)])),_:2},1032,["onClick"])])])])),_:2},1032,["title","name"])))),128))])),_:1})):(u(),k(x,{key:1,title:"暂无",type:"info",closable:!1,"show-icon":""}))])),_:1},8,["title","modelValue"]),f(L,{title:i.form.id?"编辑":"新增",modelValue:i.addTaskDialogVisible,"onUpdate:modelValue":e[6]||(e[6]=l=>i.addTaskDialogVisible=l),"close-on-click-modal":!1},{default:V((()=>[f(Y,{model:i.form,ref:"form",rules:i.rules,"label-width":"100px","label-position":"right","label-suffix":"："},{default:V((()=>[f(U,{label:"标题",prop:"title"},{default:V((()=>[f(M,{modelValue:i.form.title,"onUpdate:modelValue":e[3]||(e[3]=l=>i.form.title=l)},null,8,["modelValue"])])),_:1}),f(U,{label:"内容",prop:"content"},{default:V((()=>[f(M,{modelValue:i.form.content,"onUpdate:modelValue":e[4]||(e[4]=l=>i.form.content=l),type:"textarea",autosize:{minRows:4,maxRows:8}},null,8,["modelValue"])])),_:1}),f(U,null,{default:V((()=>[f(n,{type:"primary",onClick:e[5]||(e[5]=l=>s.submitForm("form")),loading:i.submitLoading},{default:V((()=>[w])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])],512)),[[z,i.loading]])}));T.render=x,T.__scopeId="data-v-3a7df5ee";export default T;
