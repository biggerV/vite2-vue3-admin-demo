var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(t,l,i)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[l]=i;import{a as r,b as d,c as n}from"./sys.1ef09c51.js";import u from"./User.2736e176.js";import m from"./RolePermission.fe5df9a2.js";import{b as p,Y as c,o as f,d as b,l as h,e as g,h as y,f as D,t as V,v as $,n as w}from"./vendor.cd5cedf3.js";import"./index.de78ff2b.js";const R={name:"Role",components:{User:u,RolePermission:m},data:()=>({list:[],total:0,dialogVisible:!1,formData:{},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],code:[{required:!0,message:"请输入角色编码",trigger:"blur"}]},actDialogVisible:!1,actDialogType:"",userRoleTitle:"",userRoleId:null}),methods:{isSuper:e=>"super"==e.row.code,submitForm(e){this.$refs[e].validate((e=>{if(!e)return!1;r(this.formData).then((e=>{0===e.code&&(this.dialogVisible=!1,this.formData={},this.getList())}))}))},resetForm(e){this.$refs[e].resetFields()},getList(e={}){var r,n;Object.keys(e).length<=0&&(this.total=0),d((r=((e,t)=>{for(var l in t||(t={}))o.call(t,l)&&s(e,l,t[l]);if(i)for(var l of i(t))a.call(t,l)&&s(e,l,t[l]);return e})({},e),n={moduleId:this.moduleId},t(r,l(n)))).then((e=>{0===e.code&&(this.list=e.data.list,this.total=e.data.total)})).catch((()=>{}))},showForm(e,t={}){this[e](t),this.dialogVisible=!0},add(){this.formData={moduleId:this.moduleId}},edit(e){this.formData=Object.assign({},this.list[e.index])},del(e){this.$confirm("确定要永久删除吗？",this.$t("提示"),{type:"warning"}).then((()=>{n({id:e.row.id}).then((t=>{this.list.splice(e.$index,1)}))})).catch((()=>{}))},showActDialogVisible(e,t){this.actDialogVisible=!0,this.userRoleTitle=e.row.name,this.userRoleId=Number(e.row.id),this.actDialogType=t}},created(){this.getList()}},k=g("i",{class:"el-icon-plus"},null,-1),v={style:{"margin-top":"20px"}};R.render=function(e,t,l,i,o,a){const s=p("el-button"),r=p("el-table-column"),d=p("el-table"),n=p("Pagination"),u=p("el-input"),m=p("el-form-item"),R=p("el-form"),_=p("el-dialog"),x=p("User"),j=p("RolePermission"),C=c("permit");return f(),b("div",null,[h(g(s,{size:"mini",onClick:t[1]||(t[1]=e=>a.showForm("add"))},{default:y((()=>[k,D(V(e.$t("新增")),1)])),_:1},512),[[C,"saveSysRole"]]),g(d,{data:o.list,stripe:"",style:{width:"100%"}},{default:y((()=>[g(r,{prop:"id",width:"46"}),g(r,{prop:"name",label:e.$t("名称")},null,8,["label"]),g(r,{fixed:"right",label:e.$t("操作"),width:"250",align:"center"},{default:y((t=>[h(g(s,{type:"text",onClick:e=>a.showActDialogVisible(t,"permission"),disabled:a.isSuper(t)},{default:y((()=>[D(V(e.$t("权限")),1)])),_:2},1032,["onClick","disabled"]),[[C,"saveSysRolePermission"]]),h(g(s,{type:"text",onClick:e=>a.showActDialogVisible(t,"user")},{default:y((()=>[D(V(e.$t("用户")),1)])),_:2},1032,["onClick"]),[[C,"getSysRoleUsers"]]),h(g(s,{type:"text",onClick:e=>a.showForm("edit",{index:t.$index}),disabled:a.isSuper(t)},{default:y((()=>[D(V(e.$t("编辑")),1)])),_:2},1032,["onClick","disabled"]),[[C,"saveSysRole"]]),h(g(s,{type:"text",onClick:e=>a.del(t),disabled:a.isSuper(t)},{default:y((()=>[D(V(e.$t("删除")),1)])),_:2},1032,["onClick","disabled"]),[[C,"delSysRole"]])])),_:1},8,["label"])])),_:1},8,["data"]),g("div",v,[g(n,{onChange:a.getList,total:o.total},null,8,["onChange","total"])]),g(_,{title:o.formData.id?e.$t("编辑"):e.$t("新增"),modelValue:o.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>o.dialogVisible=e),"append-to-body":"","destroy-on-close":""},{footer:y((()=>[g("div",null,[g(s,{type:"primary",onClick:t[4]||(t[4]=e=>a.submitForm("form"))},{default:y((()=>[D(V(e.$t("提交")),1)])),_:1}),g(s,{onClick:t[5]||(t[5]=e=>a.resetForm("form"))},{default:y((()=>[D(V(e.$t("重置")),1)])),_:1})])])),default:y((()=>[g(R,{model:o.formData,ref:"form",style:{width:"400px",margin:"0 auto"},rules:o.rules,"label-width":"100px"},{default:y((()=>[h(g(m,{prop:"id"},{default:y((()=>[g(u,{value:"formData.id"})])),_:1},512),[[$,!1]]),g(m,{label:e.$t("名称"),prop:"name"},{default:y((()=>[g(u,{modelValue:o.formData.name,"onUpdate:modelValue":t[2]||(t[2]=e=>o.formData.name=e)},null,8,["modelValue"])])),_:1},8,["label"]),g(m,{label:e.$t("编码"),prop:"code"},{default:y((()=>[g(u,{modelValue:o.formData.code,"onUpdate:modelValue":t[3]||(t[3]=e=>o.formData.code=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"]),o.userRoleId?(f(),b(_,{key:0,title:`${o.userRoleTitle}：${"user"===o.actDialogType?e.$t("用户列表"):e.$t("权限")}`,modelValue:o.actDialogVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>o.actDialogVisible=e),"append-to-body":"","destroy-on-close":""},{default:y((()=>["user"===o.actDialogType?(f(),b(x,{key:0,"role-id":o.userRoleId},null,8,["role-id"])):w("",!0),"permission"===o.actDialogType?(f(),b(j,{key:1,"role-id":o.userRoleId},null,8,["role-id"])):w("",!0)])),_:1},8,["title","modelValue"])):w("",!0)])};export default R;
